!function(){"use strict";function t(C){return{open:function(){var e,t,i,n,u=(t=(e=C).selection.getNode(),i=e.dom.getParent(t,"div.image"),n=e.dom.select("img",i)[0],null!=i?{file:n.getAttribute("src"),width:n.getAttribute("width").slice(0,-2),height:n.getAttribute("height").slice(0,-2),alt:n.getAttribute("alt"),align:i.classList[1],fancy:i.childNodes[0].classList[0].slice(0,-1),title:i.childNodes[0].title,caption:"span"===i.childNodes[1].localName,parent:i}:null),m="",a=new tinymce.ui.Container({type:"container",layout:"flex",direction:"row",align:"center",padding:5,spacing:15,margin:5}),l=new tinymce.ui.TextBox({name:"file",label:"File:",disabled:!0});a.add(l);var c=new tinymce.ui.Button({name:"browse_images",text:"Browse Images",onclick:function(){var e=window.location.href,t=e.lastIndexOf("/"),i=e.slice(0,t+1)+"image_select.jsp";window.open(i,"_blank","scrollbars=yes,directories=no,toolbar=no,width=800,height=600,status=no,menubar=no"),window.openCCM=new Object,window.openCCM.imageSet=function(e){return l.text(e.src),b.find("#file").value(e.src).fire("change"),b.find("#width").value(e.width).fire("change"),b.find("#height").value(e.height).fire("change"),m=e.name,!0}}});a.add(c);var o=new tinymce.ui.TextBox({name:"alternate",label:"Alternate:"}),d=new tinymce.ui.TextBox({name:"title",label:"Title:"}),r=new tinymce.ui.Container({type:"container",layout:"flex",direction:"row"}),s=new tinymce.ui.Label({text:"Alignment:"}),g=new tinymce.ui.ListBox({name:"alignment",values:[{text:"Not set",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]});r.add(s),r.add(g);var f=new tinymce.ui.Container({type:"container",layout:"flex",direction:"row"}),h=new tinymce.ui.Label({text:"Fancy Box:"}),w=new tinymce.ui.ListBox({name:"fancybox",values:[{text:"None",value:""},{text:"Zoom",value:"imageZoom"},{text:"Gallery",value:"imageGallery"}]});f.add(h),f.add(w);var v=new tinymce.ui.Checkbox({label:"Caption:",name:"caption"}),x=new tinymce.ui.Container({label:"Dimension",layout:"flex",direction:"row",align:"center",padding:5,spacing:15,margin:5}),y=new tinymce.ui.TextBox({name:"width",label:"Width"}),p=new tinymce.ui.TextBox({name:"height",label:"Height"});x.add(y),x.add({type:"label",text:"X"}),x.add(p);var b=C.windowManager.open({title:"Insert/Modify Image",width:800,height:600,body:[a,o,d,r,f,v,x],onsubmit:function(){var e=b.find("#file").value(),t=b.find("#alternate").value(),i=b.find("#width").value(),n=b.find("#height").value(),a=b.find("#title").value(),l=b.find("#alignment").value(),c=b.find("#fancybox").value();if(null!=e){var o="<a class="+c+'" href="'+e+'" title="'+a+'" data-mce-href="'+e+'"> <img src='+e+' alt="'+t+'" name="'+m+'" width="'+i+'px" height="'+n+'px" /></a>',d="";b.find("#caption").value()&&(d='<span class="caption" style="width: '+i+'px;" data-mce-style="width: '+i+'px;">'+m+"</span>");var r='<div class="image '+l+'">'+o+d+"</div>";null!=u?C.dom.replace(C.dom.createFragment(r),u.parent):C.insertContent(r)}}});null!=u&&(b.find("#file").value(u.file).fire("change"),b.find("#alternate").value(u.alt).fire("change"),b.find("#width").value(u.width).fire("change"),b.find("#height").value(u.height).fire("change"),u.align!==undefined&&b.find("#alignment").value(u.align).fire("change"),u.fancy!==undefined&&b.find("#fancybox").value(u.fancy).fire("change"),b.find("#title").value(u.title).fire("change"),b.find("#caption").value(u.caption).fire("change"))}}}tinymce.util.Tools.resolve("tinymce.PluginManager").add("ccmcmsimages",function(e){e.addButton("ccm-cms-images-button",{icon:"image",tooltip:"Insert/Edit image",onclick:t(e).open,stateSelector:"image"}),e.addMenuItem("ccm-cms-images-menu",{icon:"image",text:"Insert/Edit Images",onclick:t(e).open,stateSelector:"image",context:"insert",prependToContext:!0})})}();