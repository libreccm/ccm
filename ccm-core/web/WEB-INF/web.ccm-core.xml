<?xml version="1.0" encoding="UTF-8"?>
<web-app      xmlns="http://java.sun.com/xml/ns/j2ee"
          xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
 xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd"
            version="2.4">

    <!--- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
        basic web.xml for ccm-core and basic functions. If
        additional modules provide specific web.xml snippets they must be
        integrated before CCM is ready to work. Alternatively a
        complete web.xml file from an installation bundle may be used.
        - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->


    <display-name>CCM</display-name>
    <description>Content and Collaboration Management</description>

    <!--
        path and filename of the log4j user accessible config file
        WEB-INF/conf/log4j.properties is the built-in default value
    -->
    <context-param>
        <param-name>log4j-conf-file</param-name>
        <param-value>WEB-INF/conf/log4j.properties</param-value>
    </context-param>


    <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      Context Listener required and used to initialize the runtime environment
      before any other task is performed or any servlet initialized.
      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
    <listener>
        <listener-class>com.arsdigita.web.CCMApplicationContextListener</listener-class>
    </listener>

    <!--- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
        BASE SERVLET DECLARATIONS SECTION
        basically requirred by ANY ccm-core application to work correctly!
        - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
    <servlet>
        <servlet-name>reg</servlet-name>
        <servlet-class>com.arsdigita.web.ContextRegistrationServlet</servlet-class>
        <init-param>
            <param-name>uri</param-name>
            <param-value>/</param-value>
        </init-param>
        <load-on-startup>1</load-on-startup>
    </servlet>

    <servlet>
        <servlet-name>legacy-dispatcher</servlet-name>
        <servlet-class>com.arsdigita.sitenode.SiteNodeDispatcher</servlet-class>
        <load-on-startup>3</load-on-startup>
    </servlet>

    <servlet>
        <servlet-name>ccm-dispatcher</servlet-name>
        <servlet-class>com.arsdigita.web.DispatcherServlet</servlet-class>
        <init-param>
            <param-name>fallback-servlet</param-name>
            <param-value>legacy-dispatcher</param-value>
        </init-param>
        <load-on-startup>2</load-on-startup>
    </servlet>

    <servlet>
        <servlet-name>legacy-adapter</servlet-name>
        <servlet-class>com.arsdigita.web.LegacyAdapterServlet</servlet-class>
    </servlet>

    <servlet>
        <servlet-name>cache-manager</servlet-name>
        <servlet-class>com.arsdigita.caching.CacheServlet</servlet-class>
    </servlet>

    <servlet>
        <servlet-name>db-test</servlet-name>
        <servlet-class>com.arsdigita.web.monitoring.DBTestServlet</servlet-class>
    </servlet>

    <servlet>
        <servlet-name>versioning-log</servlet-name>
        <servlet-class>com.arsdigita.versioning.VersioningServlet</servlet-class>
    </servlet>

    <servlet>
        <servlet-name>oid-redirect</servlet-name>
        <servlet-class>com.arsdigita.web.OIDRedirectServlet</servlet-class>
    </servlet>

    <servlet>
        <servlet-name>resource-resolver</servlet-name>
        <servlet-class>com.arsdigita.web.ResourceServlet</servlet-class>
    </servlet>

    <!--
      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      ADDITIONAL SERVLET DECLARATIONS SECTION
      basically requirred by ccm-cms
      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
    -->
    <servlet>
        <servlet-name>content-section</servlet-name>
        <servlet-class>com.arsdigita.cms.ContentSectionServlet</servlet-class>
    </servlet>

    <servlet>
        <servlet-name>content-type-xsl</servlet-name>
        <servlet-class>com.arsdigita.cms.dispatcher.ContentTypeXSLServlet</servlet-class>
    </servlet>

    <servlet>
        <servlet-name>content-item-xsl</servlet-name>
        <servlet-class>com.arsdigita.cms.dispatcher.ContentItemXSLServlet</servlet-class>
    </servlet>

    <servlet>
        <servlet-name>template-xsl</servlet-name>
        <servlet-class>com.arsdigita.cms.dispatcher.TemplateXSLServlet</servlet-class>
    </servlet>

    <servlet>
        <servlet-name>TextOnlyServlet</servlet-name>
        <display-name>Text Only Servlet</display-name>
        <servlet-class>com.arsdigita.web.InternalPrefixerServlet</servlet-class>
        <init-param>
            <param-name>prefix</param-name>
            <param-value>/text</param-value>
        </init-param>
    </servlet>

    <servlet>
        <servlet-name>PrintFriendlyServlet</servlet-name>
        <display-name>Printer Friendly Output Servlet</display-name>
        <servlet-class>com.arsdigita.web.InternalPrefixerServlet</servlet-class>
        <init-param>
            <param-name>prefix</param-name>
            <param-value>/print</param-value>
        </init-param>
    </servlet>

    <!--
      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      BASE SERVLET MAPPINGS SECTION basically
      requirred by ccm-core
      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
    -->

    <servlet-mapping>
        <servlet-name>reg</servlet-name>
        <url-pattern>/themes/null/reg/*</url-pattern>
    </servlet-mapping>

    <servlet-mapping>
        <servlet-name>ccm-dispatcher</servlet-name>
        <url-pattern>/ccm/*</url-pattern>
    </servlet-mapping>

    <servlet-mapping>
        <servlet-name>legacy-adapter</servlet-name>
        <url-pattern>/themes/servlet/legacy-adapter/*</url-pattern>
    </servlet-mapping>

    <servlet-mapping>
        <servlet-name>cache-manager</servlet-name>
        <url-pattern>/expireCache/*</url-pattern>
    </servlet-mapping>

    <servlet-mapping>
        <servlet-name>db-test</servlet-name>
        <url-pattern>/dbtest</url-pattern>
    </servlet-mapping>

    <servlet-mapping>
        <servlet-name>versioning-log</servlet-name>
        <url-pattern>/versioning/*</url-pattern>
    </servlet-mapping>

    <servlet-mapping>
        <servlet-name>oid-redirect</servlet-name>
        <url-pattern>/redirect/*</url-pattern>
    </servlet-mapping>

    <servlet-mapping>
        <servlet-name>resource-resolver</servlet-name>
        <url-pattern>/resource/*</url-pattern>
    </servlet-mapping>

    <!--
      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      ADDITIONAL SERVLET MAPPINGS SECTION basically
      requirred by ccm-cms
      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
    -->

    <servlet-mapping>
        <servlet-name>content-section</servlet-name>
        <url-pattern>/themes/servlet/content-section/*</url-pattern>
    </servlet-mapping>

    <servlet-mapping>
        <servlet-name>content-item-xsl</servlet-name>
        <url-pattern>/themes/servlet/content-item/*</url-pattern>
    </servlet-mapping>

    <servlet-mapping>
        <servlet-name>content-type-xsl</servlet-name>
        <url-pattern>/themes/servlet/content-type/*</url-pattern>
    </servlet-mapping>

    <servlet-mapping>
        <servlet-name>template-xsl</servlet-name>
        <url-pattern>/themes/servlet/template/*</url-pattern>
    </servlet-mapping>

    <servlet-mapping>
        <servlet-name>TextOnlyServlet</servlet-name>
        <url-pattern>/text/*</url-pattern>
    </servlet-mapping>

    <servlet-mapping>
        <servlet-name>PrintFriendlyServlet</servlet-name>
        <url-pattern>/print/*</url-pattern>
    </servlet-mapping>

    <!--
      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
      ERROR PAGES
      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
    -->

    <error-page>
        <exception-type>com.arsdigita.dispatcher.AccessDeniedException</exception-type>
        <location>/error/access-denied.jsp</location>
    </error-page>

    <error-page>
        <exception-type>com.arsdigita.dispatcher.ObjectNotFoundException</exception-type>
        <location>/error/object-not-found.jsp</location>
    </error-page>

    <error-page>
        <exception-type>com.arsdigita.kernel.permissions.PermissionException</exception-type>
        <location>/error/permission-denied.jsp</location>
    </error-page>

    <error-page>
        <exception-type>com.arsdigita.persistence.DbNotAvailableException</exception-type>
        <location>/error/db-not-available.jsp</location>
    </error-page>

    <error-page>
        <exception-type>com.arsdigita.db.DbNotAvailableException</exception-type>
        <location>/error/db-not-available.jsp</location>
    </error-page>

    <error-page>
        <exception-type>java.lang.Exception</exception-type>
        <location>/error/general.jsp</location>
    </error-page>

    <error-page>
        <exception-type>java.lang.Error</exception-type>
        <location>/error/general.jsp</location>
    </error-page>

    <!--
      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
      TAG LIBS
      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
    -->

    <jsp-config>
        <taglib>
            <taglib-uri>/WEB-INF/bebop-show.tld</taglib-uri>
            <taglib-location>/WEB-INF/bebop-show.tld</taglib-location>
        </taglib>

        <taglib>
            <taglib-uri>/WEB-INF/bebop-define.tld</taglib-uri>
            <taglib-location>/WEB-INF/bebop-define.tld</taglib-location>
        </taglib>
    </jsp-config>

</web-app>
