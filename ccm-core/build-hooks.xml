<?xml version="1.0" encoding="iso-8859-1"?>
<project name="acs-hook" basedir="." default="compile-hook">

  <property name="build.src.dir" value="${build.dir}/src" />

  <target name="compile-hook">
    <mkdir dir="${build.src.dir}/com/arsdigita/installer"/>
    <!-- Old style initializer completely removed.                 -->
    <!-- <mkdir dir="${build.src.dir}/com/arsdigita/initializer"/> -->
    <mkdir dir="${build.src.dir}/com/redhat/persistence/pdl"/>
    <mkdir dir="${build.src.dir}/com/redhat/persistence/common"/>
    <mkdir dir="${build.src.dir}/com/redhat/persistence/oql"/>
    <javacc
      target="${src.dir}/com/arsdigita/installer/StatementParser.jj"
      outputdirectory="${build.src.dir}/com/arsdigita/installer"
      javacchome="${javacc.home.dir}"
    />
<!--  Old style initializer completely removed. 
    <javacc
      target="${src.dir}/com/arsdigita/initializer/ScriptParser.jj"
      outputdirectory="${build.src.dir}/com/arsdigita/initializer"
      javacchome="${javacc.home.dir}"
    />
-->
    <javacc
      target="${src.dir}/com/redhat/persistence/pdl/PDLParser.jj"
      outputdirectory="${build.src.dir}/com/redhat/persistence/pdl"
      javacchome="${javacc.home.dir}"
    />
    <javacc
      target="${src.dir}/com/redhat/persistence/common/SQLParser.jj"
      outputdirectory="${build.src.dir}/com/redhat/persistence/common"
      javacchome="${javacc.home.dir}"
    />
    <javacc
      target="${src.dir}/com/redhat/persistence/oql/OQLParser.jj"
      outputdirectory="${build.src.dir}/com/redhat/persistence/oql"
      javacchome="${javacc.home.dir}"
    />
    <copy todir="${build.classes.dir}">
      <fileset dir=".">
        <include name="${src.dir}/**/*.pdl"/>
      </fileset>
      <mapper to="*" from="${src.dir}/*" type="glob"/>
    </copy>
  </target>

  <target name="clean-build-hook"/>
  <target name="clean-tests-hook"/>

  <target name="deploy-hook">
    <fail message="Property this.deploy.dir not defined." 
          unless="this.deploy.dir" />
    <!-- deploy the log4j configuration file into the web applications
         document root tree                                                 -->
    <!--copy todir="${this.deploy.dir}/WEB-INF"
          file="${src.dir}/log4j2.xml"/-->
    <!-- project.xml moved to bundle cfg directory where it replaces
         former application.cfg                                            -->
    <xslt style="${ccm.tools.xsl.dir}/build-version.xsl" 
          in="${ccm.bundle.folder}/cfg/project.xml"
          out="${build.classes.dir}/ccm-version.properties" 
          classpathref="ccm.tools.classpath" force="yes" />
  </target>

</project>
